# Task Card Redesign â€” Feature Documentation

**Short description:** Redesign of the Task Card UI to improve readability, density and collapse/expand behavior while preserving existing task payloads and Firestore schema.

**Metadata**
- **Feature slug:** `feat-redesign-task-card`
- **Repository path:** `lib/src/modules/task/README.md`
- **Branch:** `feat/redesign-task-card`
- **Author / Generated by:** Documentation Agent
- **Date:** 2025-12-17
- **Status:** Draft

---

## Table of Contents
- Summary
- Important constraints
- Architecture overview (components & responsibilities)
- Data flow (diagrams and descriptions)
- Main functionalities & UX flow
- Navigation structure
- APIs & integrations
- Dependencies
- Implementation notes (key files & snippets)
- Tests & verification steps
- Security & privacy
- Troubleshooting & migration notes
- References & links

---

### Summary âœ…
This feature modernizes the presentation of task items (Task Card), improving readability and enabling collapse/expand interactions. The UI changes must remain compatible with the current task model and Firestore-backed data model.

### Important constraints âš ï¸
- Backwards compatibility: The UI must work with the existing `Task` payload shape.
- No server schema changes are assumed by default; any schema change must be coordinated with backend owners.
- Keep secrets and credentials redacted (agent detected Firebase integration; do not expose keys).

---

### Architecture overview ğŸ”§
- Frontend: Flutter app (see `lib/src/**`) â€” UI components, pages, blocs/state management.
- Backend: Firebase (Firestore) for tasks persistence, accessed via injectables under `lib/src/modules/common/infrastructure/firebase/*`.
- Routing: `lib/src/router/app_router.dart` â€” `TaskPage` is the page entry point.

Mermaid component diagram:

```mermaid
graph TD
  UI[Task Page / Task Card UI] -->|uses| Widgets[Task UI Widgets]
  Widgets -->|reads/writes| Bloc[Task Bloc / State]
  Bloc -->|calls| Repository[Task Repository]
  Repository -->|reads/writes| Firestore[(Firestore)]
  subgraph Mobile App
    UI
    Widgets
    Bloc
  end
```

---

### Data flow ğŸ’¡
- Source: Firestore collection `tasks` (implementation found in Firestore helpers).
- Flow: On page open, the UI requests tasks from repository â†’ repository maps DTOs (see `TaskDTO`) â†’ UI renders list of task cards â†’ user actions (toggle done, edit) dispatch events processed by bloc and persisted to Firestore.

Sequence diagram:

```mermaid
sequenceDiagram
  participant U as User
  participant UI as TaskPage/UI
  participant B as TaskBloc
  participant R as TaskRepository
  participant F as Firestore

  U->>UI: open tasks list
  UI->>B: dispatch LoadTasks
  B->>R: fetchTasks()
  R->>F: query tasks collection
  F-->>R: task documents
  R-->>B: Task domain objects
  B-->>UI: state with tasks
  UI-->>U: render task cards
```

---

### Main functionalities & UX flow ğŸ§­
- Show task list with redesigned card component.
- Collapse/expand details on each card.
- Toggle task completion (updates Firestore).
- Edit task content (navigates to edit flow or inline editor).

For each capability, include: Preconditions, Steps, Expected results.

Example: Toggle completion
- Preconditions: Network connected, user authenticated.
- Steps: Tap completion checkbox on card.
- Expected result: Card visually updates; Task repo writes `{isDone: true}` to Firestore; optimistic UI updates.

---

### Navigation structure ğŸ—ºï¸
- Entry: `TaskPage` (route defined in `lib/src/router/app_router.dart`).
- TaskCard appears inside the tasks list component on the `TaskPage`.

---

### APIs & integrations ğŸ”—
- Firestore collection used for tasks (found in `lib/src/modules/common/infrastructure/firebase/*`).
- Auth: Firebase Auth is used in the project (`firebase_auth` dependency); operations likely require a signed-in user.

Example request patterns (internal):
- Read tasks: repository queries Firestore collection `tasks`.
- Write task update: repository writes document update `{ isDone: true }`.

---

### Dependencies ğŸ“¦
- Flutter SDK (see `pubspec.yaml`) â€” project is Flutter/Dart.
- Firebase: `firebase_core`, `firebase_auth`, `cloud_firestore`.
- State & codegen: `flutter_bloc`, `freezed`, `json_serializable`, `injectable`.
- UI toolkit: `design_system` package.

---

### Implementation notes (key files & snippets) ğŸ”
Files discovered relevant to the feature:
- `lib/src/modules/task/presentation/pages/task_page.dart` â€” task page scaffold
- `lib/src/modules/common/domain/models/task.dart` â€” Task domain model
- `lib/src/modules/common/infrastructure/dto/task_dto.dart` â€” DTO mapping to domain
- Firestore helpers under `lib/src/modules/common/infrastructure/firebase/` â€” firestore helper functions and injection
- Router: `lib/src/router/app_router.dart` â€” route to `TaskPage`

Missing / TODOs (items agent could not locate):
- **Task Card widget file not found** (expected e.g., `lib/src/modules/task/presentation/widgets/task_card.dart`). If present, please provide path so docs can include detailed snippets and visual notes.
- Unit / widget tests for Task Card were not found â€” consider adding widget tests (`flutter_test`) to cover UI behavior (expand/collapse, toggle).

Important snippet example (DTO â†’ domain mapping):

```dart
// lib/src/modules/common/infrastructure/dto/task_dto.dart
factory TaskDTO.fromDomain(Task task) => TaskDTO(
  uid: task.uid,
  title: task.title,
  content: task.content,
  isDone: task.isDone,
  dateCreated: task.dateCreated,
);
```

---

### Tests & verification âœ…
Verification checklist performed by agent:
- [x] Located `Task` domain model and DTOs.
- [x] Located `TaskPage` route and reference in router.
- [x] Detected Firebase dependencies in `pubspec.yaml`.
- [ ] **Task Card widget file not found** â€” needs confirmation.
- [ ] No unit/widget tests located for `task` UI flows â€” recommend adding.

Manual QA steps:
- Run app, navigate to the Tasks page, verify redesigned card visuals and behaviors.
- Run `flutter test` and add widget tests for expand/collapse, checkbox toggle.

---

### Security & privacy ğŸ”
- The repo includes Firebase config files; do not commit or expose private keys. Agent redacted secrets and will not include them in documentation.
- Auth flow uses `firebase_auth`, ensure that rules for Firestore are correct and secure.

---

### Troubleshooting & migration notes ğŸ› ï¸
- If performance issues appear when rendering many Task Cards, implement lazy list virtualization (e.g., `ListView.builder`) and avoid expensive widget rebuilds.
- If Firestore read costs increase, consider pagination or aggregation.

---

### References & links ğŸ“
- Router: `lib/src/router/app_router.dart`
- Task page: `lib/src/modules/task/presentation/pages/task_page.dart`
- Task model/dto: `lib/src/modules/common/domain/models/task.dart`, `lib/src/modules/common/infrastructure/dto/task_dto.dart`
- Pubspec / dependencies: `pubspec.yaml`

---

## Next steps / Recommended actions
1. Confirm the path for the Task Card widget (if it exists) so documentation can include screenshots/snippets.
2. Add widget tests to cover Task Card behaviors (expand/collapse, toggle completion).
3. If you want, I can create focused widget-level docs & add example screenshots or assets to `lib/src/modules/task/assets/`.

---

*Generated by Documentation Agent â€” draft.*

<!-- AUTO-GENERATED DOC START -->

# task â€” Suggested documentation (automated)

## Summary of changes
The following files were changed in this module:
- `presentation/pages/task_page.dart`

## Suggested updates
- Update the 'Implementation notes' and 'Main functionalities' sections if behavior changed.
- Verify API and data-flow sections reflect field additions or removals.

<!-- AUTO-GENERATED DOC END -->






